{"url":"https://lf3-short.ibytedapm.com/slardar/fe/sdk-web/plugins/blank-screen.1.1.6.js","id":"00f9fdef5b714e84c25727ee8d83d46b6305e6bf","source":"!function(){\"use strict\";var r=function(){return(r=Object.assign||function(n){for(var e,r=1,t=arguments.length;r<t;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}).apply(this,arguments)};function U(n,e){var r=\"function\"==typeof Symbol&&n[Symbol.iterator];if(!r)return n;var t,o,i=r.call(n),u=[];try{for(;(void 0===e||0<e--)&&!(t=i.next()).done;)u.push(t.value)}catch(n){o={error:n}}finally{try{t&&!t.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return u}function t(n){return\"object\"==typeof n&&null!==n}function H(n){return\"function\"==typeof n}function u(){if(\"object\"==typeof window&&t(window))return window}function N(){if(\"object\"==typeof document&&t(document))return document}function i(n){if(n)return n.__SLARDAR_REGISTRY__||(n.__SLARDAR_REGISTRY__={Slardar:{plugins:[],errors:[]}}),n.__SLARDAR_REGISTRY__.Slardar}var f=function(n,e,r,t){void 0===e&&(e={}),void 0===t&&(t=[]);try{var o=n.apply(void 0,function(n,e,r){if(r||2===arguments.length)for(var t,o=0,i=e.length;o<i;o++)!t&&o in e||((t=t||Array.prototype.slice.call(e,0,o))[o]=e[o]);return n.concat(t||Array.prototype.slice.call(e))}([],U(t),!1));return o&&o(e,r)||[]}catch(n){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=i(u());r&&(r.errors||(r.errors=[]),r.errors.push(n))}(n),[]}};var s=function(n,e){return t(n)?r(r({},e),n):!!n&&e};function F(e){return e.requestIdleCallback||function(n){return e.setTimeout(n,1)}}function W(r,t,n,o,i){if(void 0===t&&(t=0),void 0===n&&(n=0),void 0===o&&(o=1.5),void 0===i&&(i=c),!r||-1<i.indexOf(r.tagName)||o<=n||4<t)return n;var e=function(){if(!t)return 0;var n=r.getBoundingClientRect(),e=n.top,n=n.height;return e>innerHeight||n<=0?0:1/Math.pow(2,t-1)}();return[].reduceRight.call(r.children,function(n,e){return W(e,t+1,n,o,i)},n+e)}function z(e,n,r,t){if(u()&&\"Promise\"in window&&Promise&&r&&t){if(r.html2canvas)return i(),0;var o=t.createElement(\"script\");o.src=n,null!==(n=t.head)&&void 0!==n&&n.appendChild(o),o.onload=i}function i(){F(r)(function(){r.html2canvas&&r.html2canvas(t.body,{scale:360/r.innerWidth}).then(function(n){e(n.toDataURL(\"image/jpeg\",.1))})})}}var c=[\"SCRIPT\",\"STYLE\",\"META\",\"HEAD\"],J=[\"js_error\",\"http\",\"resource_error\"],l=function(B,C,M,Y,G){if(void 0===B&&(B=u()),void 0===C&&(C=N()),void 0===M&&(M=function(){if(u()&&H(window.PerformanceObserver))return window.PerformanceObserver}()),void 0===Y&&(Y=function(){if(u()&&H(window.MutationObserver))return window.MutationObserver}()),void 0===G&&(G=function(){if(u()&&t(window.performance))return window.performance}()),C&&B)return function(n,e){var r,t,o,i,u,c,a,f,s,l,d,v=n.threshold,p=n.screenshot,h=n.rootSelector,y=n.autoDetect,m=n.ssUrl,w=F(B),g=U([t=(r=G)&&r.timing||void 0,function(){return r&&r.now?r.now():(Date.now?Date.now():+new Date)-(t&&t.navigationStart||0)},function(n){var e=(r||{}).getEntriesByType;return H(e)&&e.call(r,n)||[]},function(){var n=(r||{}).clearResourceTimings;H(n)&&n.call(r)},function(n){var e=(r||{}).getEntriesByName;return H(e)&&e.call(r,n)||[]}],2)[1],b=0,_=!1,S=function(n){o&&e&&e({ev_type:\"blank_screen\",payload:{timestamp:o[0],score:o[1],screenshot:n,error:i}})},E=(c=function(){o&&!_&&(_=!0,L(),p?z(S,m,B,C):S())},function(){a||(f=Date.now(),a=B.setTimeout(function(){a=0,f<b||c()},1e4<g()?2e3:8e3))});d=U((s=function(){_||S()},l=!1,[function(n){l||(l=!0,s&&s(n))}]),1)[0],[\"unload\",\"beforeunload\",\"pagehide\"].forEach(function(n){addEventListener(n,d)});function R(){u&&clearTimeout(u),u=B.setTimeout(function(){w(function(){B.requestAnimationFrame(function(){var n=h?C.querySelector(h):C.body;n&&((n=W(n,0,0,v))<v?(o=[Date.now(),n],E()):o=void 0)})})},1e3)}var D,T,A,O,j,k,L=function(){clearTimeout(u),P&&P(),q&&q()},n=U((I=R,D=(x=Y)&&new x(I),[function(n,e){D&&n&&D.observe(n,e)},function(){return D&&D.disconnect()}]),2),x=n[0],P=n[1],I=U((A=function(n,e,r){return u&&1<r.length&&R()},k=(T=M)&&new T(function(n,t){n.getEntries?n.getEntries().forEach(function(n,e,r){return A(n,e,r,t)}):j&&j(),O&&t.disconnect()}),[function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(!T||!k)return j&&j();try{e.forEach(function(n){-1<T.supportedEntryTypes.indexOf(n)&&k.observe({type:n,buffered:!1})})}catch(n){try{k.observe({entryTypes:e})}catch(n){return j&&j()}}},function(){return k&&k.disconnect()}]),2),n=I[0],q=I[1];return y&&(x(null===(x=N())||void 0===x?void 0:x.body,{subtree:!0,childList:!0}),n(\"longtask\",\"resource\"),R()),[L,function(n){_||(b=Date.now(),i=function(n,e){if(-1===J.indexOf(e.ev_type))return n;if(\"http\"===e.ev_type&&e.payload.response.status<400)return n;if(n&&J.indexOf(n.type)<J.indexOf(e.ev_type))return n;var r=\"\";switch(e.ev_type){case\"js_error\":r=e.payload.error.message;break;case\"http\":r=e.payload.request.url;break;case\"resource_error\":r=e.payload.url}return{type:e.ev_type,message:r,timestamp:Date.now()}}(i=i&&1e4<b-i.timestamp?void 0:i,n))},R]}},d=\"blankScreen\";function o(u,c,a){u.on(\"init\",function(){var n,e,r,t,o,i,o=(e=d,o=c,e=null===(n=(n=u).config())||void 0===n?void 0:n.plugins[e],s(e,o)||s(a,c));o&&(o=U(f(l,o,u.report.bind(u)),3),r=o[0],t=o[1],o=o[2],u.on(\"report\",i=function(n){return t(n),n}),u.on(\"beforeDestroy\",function(){r(),u.off(\"report\",i)}),u.provide(\"detectBlankScreen\",o))})}var n,e,a,v={autoDetect:!0,threshold:1.5,screenshot:!0,ssUrl:\"https://sf16-short-va.bytedapm.com/slardar/fe/sdk-web/screenshot.min.js\"};e=(null===(n=null===document||void 0===document?void 0:document.currentScript)||void 0===n?void 0:n.getAttribute(\"src\"))||\"\",(a=N())&&e&&((a=a.createElement(\"a\")).href=e,\"/\"!==(e=a.pathname||\"/\")[0]&&(e=\"/\"+e),a.href,a.protocol.slice(0,-1),a.hostname,a.search.substring(1),a.hash);var p,h,y,m,w=\"1.1.6\";p=d,h=function(n,e){o(n,v,e)},(y=void 0===y?i(u()):y)&&y.plugins&&(m=p,y.plugins.filter(function(n){return n.name===m&&n.version===w})[0]||y.plugins.push({name:p,version:w,apply:h}))}();\n"}